(function(){function E(M,K){var O;K=K||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=K.touchBoundary||10;this.layer=M;this.tapDelay=K.tapDelay||200;this.tapTimeout=K.tapTimeout||700;if(E.notNeeded(M)){return}function H(Q,P){return function(){return Q.apply(P,arguments)}}var J=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var I=this;for(var L=0,N=J.length;L<N;L++){I[J[L]]=H(I[J[L]],I)}if(F){M.addEventListener("mouseover",this.onMouse,true);M.addEventListener("mousedown",this.onMouse,true);M.addEventListener("mouseup",this.onMouse,true)}M.addEventListener("click",this.onClick,true);M.addEventListener("touchstart",this.onTouchStart,false);M.addEventListener("touchmove",this.onTouchMove,false);M.addEventListener("touchend",this.onTouchEnd,false);M.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){M.removeEventListener=function(P,R,Q){var S=Node.prototype.removeEventListener;if(P==="click"){S.call(M,P,R.hijacked||R,Q)}else{S.call(M,P,R,Q)}};M.addEventListener=function(P,S,Q){var R=Node.prototype.addEventListener;if(P==="click"){R.call(M,P,S.hijacked||(S.hijacked=function(T){if(!T.propagationStopped){S(T)}}),Q)}else{R.call(M,P,S,Q)}}}if(typeof M.onclick==="function"){O=M.onclick;M.addEventListener("click",function(P){O(P)},false);M.onclick=null}}var A=navigator.userAgent.indexOf("Windows Phone")>=0;var F=navigator.userAgent.indexOf("Android")>0&&!A;var C=/iP(ad|hone|od)/.test(navigator.userAgent)&&!A;var D=C&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);var B=C&&(/OS [6-7]_\d/).test(navigator.userAgent);var G=navigator.userAgent.indexOf("BB10")>0;E.prototype.needsClick=function(H){switch(H.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(H.disabled){return true}break;case"input":if((C&&H.type==="file")||H.disabled){return true}break;case"label":case"iframe":case"video":return true}return(/\bneedsclick\b/).test(H.className)};E.prototype.needsFocus=function(H){switch(H.nodeName.toLowerCase()){case"textarea":return true;case"select":return !F;case"input":switch(H.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return !H.disabled&&!H.readOnly;default:return(/\bneedsfocus\b/).test(H.className)}};E.prototype.sendClick=function(K,J){var I,H;if(document.activeElement&&document.activeElement!==K){document.activeElement.blur()}H=J.changedTouches[0];I=document.createEvent("MouseEvents");I.initMouseEvent(this.determineEventType(K),true,true,window,1,H.screenX,H.screenY,H.clientX,H.clientY,false,false,false,false,0,null);I.forwardedTouchEvent=true;K.dispatchEvent(I)};E.prototype.determineEventType=function(H){if(F&&H.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};E.prototype.focus=function(I){var H;if(C&&I.setSelectionRange&&I.type.indexOf("date")!==0&&I.type!=="time"&&I.type!=="month"){H=I.value.length;I.setSelectionRange(H,H)}else{I.focus()}};E.prototype.updateScrollParent=function(J){var H,I;H=J.fastClickScrollParent;if(!H||!H.contains(J)){I=J;do{if(I.scrollHeight>I.offsetHeight){H=I;J.fastClickScrollParent=I;break}I=I.parentElement}while(I)}if(H){H.fastClickLastScrollTop=H.scrollTop}};E.prototype.getTargetElementFromEventTarget=function(H){if(H.nodeType===Node.TEXT_NODE){return H.parentNode}return H};E.prototype.onTouchStart=function(I){var J,H,K;if(I.targetTouches.length>1){return true}J=this.getTargetElementFromEventTarget(I.target);H=I.targetTouches[0];if(C){K=window.getSelection();if(K.rangeCount&&!K.isCollapsed){return true}if(!D){if(H.identifier&&H.identifier===this.lastTouchIdentifier){I.preventDefault();return false}this.lastTouchIdentifier=H.identifier;this.updateScrollParent(J)}}this.trackingClick=true;this.trackingClickStart=I.timeStamp;this.targetElement=J;this.touchStartX=H.pageX;this.touchStartY=H.pageY;if((I.timeStamp-this.lastClickTime)<this.tapDelay){I.preventDefault()}return true};E.prototype.touchHasMoved=function(I){var J=I.changedTouches[0],H=this.touchBoundary;if(Math.abs(J.pageX-this.touchStartX)>H||Math.abs(J.pageY-this.touchStartY)>H){return true}return false};E.prototype.onTouchMove=function(H){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(H.target)||this.touchHasMoved(H)){this.trackingClick=false;this.targetElement=null}return true};E.prototype.findControl=function(H){if(H.control!==undefined){return H.control}if(H.htmlFor){return document.getElementById(H.htmlFor)}return H.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};E.prototype.onTouchEnd=function(L){var J,M,K,H,I,N=this.targetElement;if(!this.trackingClick){return true}if((L.timeStamp-this.lastClickTime)<this.tapDelay){this.cancelNextClick=true;return true}if((L.timeStamp-this.trackingClickStart)>this.tapTimeout){return true}this.cancelNextClick=false;this.lastClickTime=L.timeStamp;M=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(B){I=L.changedTouches[0];N=document.elementFromPoint(I.pageX-window.pageXOffset,I.pageY-window.pageYOffset)||N;N.fastClickScrollParent=this.targetElement.fastClickScrollParent}K=N.tagName.toLowerCase();if(K==="label"){J=this.findControl(N);if(J){this.focus(N);if(F){return false}N=J}}else{if(this.needsFocus(N)){if((L.timeStamp-M)>100||(C&&window.top!==window&&K==="input")){this.targetElement=null;return false}this.focus(N);this.sendClick(N,L);if(!C||K!=="select"){this.targetElement=null;L.preventDefault()}return false}}if(C&&!D){H=N.fastClickScrollParent;if(H&&H.fastClickLastScrollTop!==H.scrollTop){return true}}if(!this.needsClick(N)){L.preventDefault();this.sendClick(N,L)}return false};E.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};E.prototype.onMouse=function(H){if(!this.targetElement){return true}if(H.forwardedTouchEvent){return true}if(!H.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(H.stopImmediatePropagation){H.stopImmediatePropagation()}else{H.propagationStopped=true}H.stopPropagation();H.preventDefault();return false}return true};E.prototype.onClick=function(I){var H;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(I.target.type==="submit"&&I.detail===0){return true}H=this.onMouse(I);if(!H){this.targetElement=null}return H};E.prototype.destroy=function(){var H=this.layer;if(F){H.removeEventListener("mouseover",this.onMouse,true);H.removeEventListener("mousedown",this.onMouse,true);H.removeEventListener("mouseup",this.onMouse,true)}H.removeEventListener("click",this.onClick,true);H.removeEventListener("touchstart",this.onTouchStart,false);H.removeEventListener("touchmove",this.onTouchMove,false);H.removeEventListener("touchend",this.onTouchEnd,false);H.removeEventListener("touchcancel",this.onTouchCancel,false)};E.notNeeded=function(J){var K;var I;var H;var L;if(typeof window.ontouchstart==="undefined"){return true}I=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(I){if(F){K=document.querySelector("meta[name=viewport]");if(K){if(K.content.indexOf("user-scalable=no")!==-1){return true}if(I>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(G){H=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(H[1]>=10&&H[2]>=3){K=document.querySelector("meta[name=viewport]");if(K){if(K.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(J.style.msTouchAction==="none"||J.style.touchAction==="manipulation"){return true}L=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(L>=27){K=document.querySelector("meta[name=viewport]");if(K&&(K.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)){return true}}if(J.style.touchAction==="none"||J.style.touchAction==="manipulation"){return true}return false};E.attach=function(I,H){return new E(I,H)};if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define(function(){return E})}else{if(typeof module!=="undefined"&&module.exports){module.exports=E.attach;module.exports.FastClick=E}else{window.FastClick=E}}}());